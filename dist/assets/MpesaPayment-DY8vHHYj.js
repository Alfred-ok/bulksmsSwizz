import{r as l,_ as g,R as w,a as S,c as b,P as c,n as v,A as f,j as e}from"./index-DxiAcUCP.js";import{S as y}from"./sweetalert2.esm.all-DOYwHpwi.js";import{C as j,a as x}from"./CRow-BRiTm5IC.js";import{C as P,a as E}from"./CCardBody-CGlVQwBB.js";import{C as D}from"./CImage-D-7Qu34e.js";import{C as F}from"./DefaultLayout-BmgnOIWU.js";import{C as M}from"./CForm-DJgMOtbZ.js";import{a as I}from"./CFormControlWrapper-BYq7y8h4.js";import{C as R}from"./CFormInput-BveaeGyj.js";import{b as k}from"./CContainer-HlgF_dlK.js";import"./index.esm-Cy3LKcd6.js";import"./CCloseButton-BkFP51Rh.js";var u=l.forwardRef(function(t,d){var s=t.children,o=t.className,r=g(t,["children","className"]);return w.createElement("div",S({className:b("card-footer",o)},r,{ref:d}),s)});u.propTypes={children:c.node,className:c.string};u.displayName="CCardFooter";var C=l.forwardRef(function(t,d){var s=t.children,o=t.as,r=o===void 0?"p":o,m=t.className,a=g(t,["children","as","className"]);return w.createElement(r,S({className:b("card-text",m)},a,{ref:d}),s)});C.propTypes={as:c.elementType,children:c.node,className:c.string};C.displayName="CCardText";function Y(){v();const{purchaseSmsUnit:t,setPurchaseSmsUnit:d}=l.useContext(f),{OrganisationDataID:s,setOrganisationDataID:o}=l.useContext(f),[r,m]=l.useState(""),a=t.quantity*t.price,N=async h=>{h.preventDefault();try{const n=await fetch("https://wazimobile-sms-backend.onrender.com/mpesapayment",{method:"POST",headers:{"Content-Type":"application/json"},body:r});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const p=await n.text();if(console.log(p),p==="Success"){try{console.log(s);const i=await fetch(`https://wazimobile-sms-backend.onrender.com/update-organisation-payment/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({total:a,quantity:t.quantity})});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const T=await i.text();console.log(T)}catch(i){console.error("There was a problem with the fetch operation:",i)}y.fire({title:p,text:"Paid Successfully",icon:"success"})}else y.fire({icon:"error",title:p,text:"Something went wrong! Check Mpesa Code and try again"})}catch(n){console.error("There was a problem with the fetch operation:",n)}};return e.jsx(e.Fragment,{children:e.jsx(j,{children:e.jsx(x,{xs:10,style:{margin:"12px auto"},children:e.jsx(P,{style:{boxShadow:"0px 15px 34px 0px rgba(0,0,0,0.2)"},children:e.jsxs(E,{children:[e.jsx("div",{style:{margin:"auto 0px",backgroundColor:"#0074d9",color:"#fff",height:"60px",borderRadius:"10px"},children:e.jsxs(j,{children:[e.jsx(x,{children:e.jsx("div",{style:{padding:"15px 25px",fontSize:"20px"},children:"Payment Date:  12/10/2024 15:17:29"})}),e.jsx(x,{children:e.jsxs("div",{style:{display:"flex",justifyContent:"end",alignItems:"center",padding:"15px 25px",fontSize:"20px"},children:["Sms Total:  ",a]})})]})}),e.jsxs(C,{style:{padding:"15px 20px"},children:[e.jsx("p",{children:e.jsx(D,{src:"src/assets/images/m-pesa.png",height:81})}),e.jsx("p",{children:"1. Go to the M-PESA menu on your phone "}),e.jsx("p",{children:"2. Select Buy Goods and Services Option"}),e.jsx("p",{children:"3. Enter the following till number: 5592679"}),e.jsxs("p",{children:["4. Enter the total amount (KSh.",a," )"]}),e.jsx("p",{children:"5. Enter your PIN and then send the money"}),e.jsx("p",{children:"6. You will receive a transaction confirmation SMS from M-PESA"}),e.jsx("p",{children:"7. Enter your M-PESA Confirmation Code only here below:"})]}),e.jsx(u,{children:e.jsxs(F,{color:"success",children:[e.jsx("h5",{children:"Enter Payment Details"}),e.jsx(M,{onSubmit:N,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(I,{htmlFor:"exampleFormControlInput1",children:"Mpesa Code"}),e.jsx(R,{type:"text",id:"exampleFormControlInput1",placeholder:"Mpesa Code",style:{borderColor:"rgba(71, 71, 212,0.6)",width:"40%"},value:r,onChange:h=>m(h.target.value)}),e.jsx("div",{className:"col-auto",children:e.jsx(k,{color:"success",type:"submit",style:{marginTop:"20px",color:"#fff"},children:"Confirm"})})]})})]})})]})})})})})}export{Y as default};
