import{r as n,e as O,j as e,L as T}from"./index-C301rl4l.js";import{C as f}from"./index.esm-DfaUp9eW.js";import{a as L,b as N,d}from"./CRow-DzvM-Fku.js";import{C as R,a as A}from"./CCardBody-BB8X-jUM.js";import{C as U,a as B,b as G,d as M,e as P,f as _,g as $,h as z,i as J}from"./DefaultLayout-D85aDnQc.js";import{C as j}from"./CAlert-DXt3K87V.js";import{C as K}from"./CFormSelect-CWPKjNEb.js";function Z(){const[p,h]=n.useState([]),[C,x]=n.useState(!1),[m,i]=n.useState(""),u=n.useRef(),[g,v]=n.useState([]),F=O.get("groupId"),[y,b]=n.useState(),a=s=>{const t=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],r=[".xls",".xlsx"];return t.includes(s.type)||r.some(o=>s.name.toLowerCase().endsWith(o))},w=s=>{s.preventDefault()},D=s=>{s.preventDefault();const t=Array.from(s.dataTransfer.files),r=t.filter(a);t.filter(l=>!a(l)).length>0?i("Only Excel files (.xls, .xlsx) are allowed."):i(""),h(l=>[...l,...r])},S=s=>{const t=Array.from(s.target.files),r=t.filter(a);t.filter(l=>!a(l)).length>0?i("Only Excel files (.xls, .xlsx) are allowed."):i(""),h(l=>[...l,...r])},k=s=>{h(t=>t.filter(r=>r!==s))},E=()=>{x(!0);const s=r=>new Promise((o,l)=>{const c=new FileReader;c.readAsDataURL(r),c.onload=()=>o(c.result),c.onerror=I=>l(I)});(async()=>{try{const r=await Promise.all(p.map(async l=>({filename:l.name,contentType:l.type,data:await s(l)})));fetch("https://81c9-69-197-145-100.ngrok-free.app/messageinfile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgCode:y,files:r})}).then(l=>l.text()).then(l=>console.log(l)).catch(l=>console.error("Error:",l))}catch(r){console.error("Error encoding files:",r)}})()};return n.useEffect(()=>{try{fetch(`https://81c9-69-197-145-100.ngrok-free.app/org_group_id/${F}`).then(s=>(console.log(s),s.json())).then(s=>{console.log(s),v(s)}).catch(s=>{console.log(s)})}catch(s){console.error("There was a problem with the fetch operation:",s)}},[]),e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"justify-content-md-center",children:e.jsx(N,{xs:10,children:e.jsx(R,{className:"mb-4",style:{boxShadow:"0px 15px 34px 0px rgba(0,0,0,0.2)"},children:e.jsxs(A,{children:[e.jsx(U,{children:e.jsxs(j,{color:"primary",variant:"solid",className:"d-flex align-items-center",xs:10,children:[e.jsx(f,{icon:B,className:"flex-shrink-0 me-2",width:34,height:34}),e.jsx("div",{children:e.jsx("h3",{children:"Upload file"})})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs(K,{id:"exampleFormControlInput1","aria-label":"Default select example",value:y,onChange:s=>b(s.target.value),style:{borderColor:"rgba(71, 71, 212,0.6)"},children:[e.jsx("option",{value:"",children:"Select Sender Id"})," ",g&&g.map((s,t)=>e.jsx("option",{value:s.org_Code,children:s.url},t))]})}),e.jsxs("div",{style:{background:"#f3f4f6",border:"2px dashed rgba(71, 71, 212,0.6)",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",color:"gray",padding:"20px"},onDragOver:w,onDrop:D,children:[e.jsx(f,{icon:G,size:"3xl"}),e.jsx("h3",{children:"Drag and Drop files to upload"}),e.jsx("h3",{children:"Or"}),e.jsx("input",{type:"file",multiple:!0,onChange:S,hidden:!0,ref:u}),e.jsx(d,{type:"button",color:"dark",id:"inputGroupFileAddon04",onClick:()=>u.current.click(),style:{margin:"20px"},children:"Select Files"})]}),m&&e.jsx(j,{color:"danger",children:m}),p.length>0&&e.jsxs("div",{style:{margin:"40px"},children:[e.jsx(M,{flush:!0,children:p.map((s,t)=>e.jsxs(P,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.name,e.jsx(d,{color:"danger",style:{color:"#fff"},onClick:()=>k(s),children:e.jsx(f,{icon:_})})]},t))}),e.jsx("div",{style:{margin:"15px",width:"100%"},className:"d-grid gap-2",children:e.jsx(d,{color:"success",onClick:E,style:{marginRight:"20px",color:"#fff"},xs:10,children:"Upload"})})]})]})})})}),e.jsx($,{visible:C,onClose:()=>x(!1),"aria-labelledby":"LiveDemoExampleLabel",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(z,{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",padding:"50px",textAlign:"center"},children:[e.jsx(J,{style:{width:"100%"},children:e.jsx("h2",{children:"Uploaded Successfully"})}),e.jsx(T,{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(d,{color:"primary",className:"mt-3",style:{width:"80%"},onClick:()=>x(!1),children:"OK"})})]})})]})}export{Z as default};
