import{r,e as O,n as _,j as e,C as J}from"./index-C301rl4l.js";import{C as j}from"./index.esm-DfaUp9eW.js";import{C as q,a as K}from"./CCardBody-BB8X-jUM.js";import{C as Q,g as W,i as X,h as Y}from"./DefaultLayout-D85aDnQc.js";import{C as Z}from"./CAlert-DXt3K87V.js";import{d as p,c as ee}from"./CRow-DzvM-Fku.js";import{c as te,a as se}from"./cil-search-BgoJf-gK.js";import{C as E}from"./CForm-DyX8Mp35.js";import{C as re,a as ae}from"./CInputGroupText-BfLlLb0E.js";import{C as H}from"./CFormInput-VSLTUyno.js";import{C as oe,a as le,b as M,c as d,e as l,d as ne}from"./CTable-BgNGgvOw.js";import{c as ie}from"./cil-sync-DTxDyR9B.js";import{C as ce,a as b}from"./CPaginationItem-CfWfORXZ.js";import{C as he}from"./CModalHeader-DczIfwCg.js";import"./CFormSelect-CWPKjNEb.js";function ze(){const[m,P]=r.useState([]),[u,g]=r.useState(!1),[F,y]=r.useState(!1),[i,v]=r.useState({}),[w,L]=r.useState(!1),[T,x]=r.useState(!1),[c,S]=r.useState([]),[$,B]=r.useState(""),[a,f]=r.useState(1),h=10,z=a*h,k=z-h,I=c.slice(k,z),D=O.get("groupId");r.useState({});const[N,C]=r.useState({}),R=t=>{const s=t.target.value.toLowerCase();B(s);const o=m.filter(n=>n.groupName.toLowerCase().includes(s));S(o)},U=_();r.useEffect(()=>{x(!1);try{fetch(`https://81c9-69-197-145-100.ngrok-free.app/groups/get/${D}`).then(t=>t.json()).then(t=>{console.log(t),P(t),S(t),x(!0)}).catch(t=>{console.log(t),x(!0)})}catch(t){console.error("There was a problem with the fetch operation:",t)}},[w]);const G=async t=>{t.preventDefault(),y(!0);try{const s=await fetch(`https://81c9-69-197-145-100.ngrok-free.app/groups/${i.groupId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({groupName:i.groupName})});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);L(!w)}catch(s){console.error("There was a problem with the fetch operation:",s)}y(!1),g(!u)};r.useEffect(()=>{G()},[]);const V=async t=>{try{const s=await fetch(`https://81c9-69-197-145-100.ngrok-free.app/group-members/getGroup${t}`);if(!s.ok)throw new Error(`Failed to fetch group members: ${s.status} ${s.statusText}`);const o=s.headers.get("Content-Type");if(o&&o.includes("application/json")){const n=await s.json();C(A=>({...A,[t]:n.length||0}))}else C(n=>({...n,[t]:0}))}catch(s){console.error(`Error fetching total for group ${t}:`,s),C(o=>({...o,[t]:0}))}};return r.useEffect(()=>{c.length>0&&c.forEach(t=>{V(t.groupId)})},[c]),e.jsxs(e.Fragment,{children:[e.jsx(q,{style:{boxShadow:"0px 15px 34px 0px rgba(0,0,0,0.2)",marginBottom:"30px",backgroundColor:"rgba(255,255,255,0.7)"},children:e.jsxs(K,{children:[e.jsx(Q,{style:{fontSize:"2em",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs(Z,{color:"primary",variant:"solid",style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsxs("svg",{style:{marginRight:"8px"},xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",fill:"currentColor",class:"bi bi-buildings",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M14.763.075A.5.5 0 0 1 15 .5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V14h-1v1.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V10a.5.5 0 0 1 .342-.474L6 7.64V4.5a.5.5 0 0 1 .276-.447l8-4a.5.5 0 0 1 .487.022M6 8.694 1 10.36V15h5zM7 15h2v-1.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5V15h2V1.309l-7 3.5z"}),e.jsx("path",{d:"M2 11h1v1H2zm2 0h1v1H4zm-2 2h1v1H2zm2 0h1v1H4zm4-4h1v1H8zm2 0h1v1h-1zm-2 2h1v1H8zm2 0h1v1h-1zm2-2h1v1h-1zm0 2h1v1h-1zM8 7h1v1H8zm2 0h1v1h-1zm2 0h1v1h-1zM8 5h1v1H8zm2 0h1v1h-1zm2 0h1v1h-1zm0-2h1v1h-1z"})]}),"Groups"]}),e.jsxs(p,{variant:"outline",color:"light",onClick:()=>U("/create-new-group"),children:[e.jsx(j,{icon:te,style:{marginRight:"5px"}}),"Create New Group"]})]})}),T&&T?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"mb-3",children:e.jsxs(re,{className:"mb-3",style:{width:"60%",margin:"0 auto"},children:[e.jsx(ae,{id:"basic-addon1",color:"dark",style:{color:"#fff",backgroundColor:"rgb(71, 71, 212)"},children:e.jsx(j,{icon:se})}),e.jsx(H,{type:"text",id:"searchInput",placeholder:"Search by group Name",value:$,onChange:R,style:{borderColor:"rgb(71, 71, 212)"}})]})}),e.jsxs(oe,{responsive:!0,small:!0,hover:!0,borderless:!0,stripedColumns:!0,children:[e.jsx(le,{children:e.jsxs(M,{color:"dark",style:{textAlign:"center"},children:[e.jsx(d,{scope:"col",children:"#"}),e.jsx(d,{scope:"col",children:"Group Name"}),e.jsx(l,{scope:"col",children:"GroupId"}),e.jsx(l,{scope:"col",children:"Total contacts"}),e.jsx(d,{scope:"col",children:"Action"})]})}),I&&I.map((t,s)=>e.jsx(ne,{children:e.jsxs(M,{style:{textAlign:"center"},color:s%2?"primary":"",children:[e.jsx(d,{scope:"row",children:k+s+1}),e.jsx(l,{children:t.groupName}),e.jsx(l,{children:t.groupId}),e.jsx(l,{children:N[t.groupId]!==void 0?N[t.groupId]:"Loading..."}),e.jsx(l,{children:e.jsxs(p,{color:"dark",variant:"outline",onClick:()=>{g(!u),v(t)},style:{display:"flex",alignItems:"center",margin:"2px auto"},children:[e.jsx(j,{icon:ie,style:{marginRight:"5px"}})," Update"]})})]})},t.groupId))]}),e.jsxs(ce,{"aria-label":"Page navigation example",children:[e.jsx(b,{onClick:()=>f(a-1),disabled:a===1,children:"Previous"}),[...Array(Math.ceil(m.length/h))].map((t,s)=>e.jsx(b,{active:s+1===a,onClick:()=>f(s+1),children:s+1},s+1)),e.jsx(b,{onClick:()=>f(a+1),disabled:a===Math.ceil(m.length/h),children:"Next"})]})]}):e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"end",color:"black",width:"100%",marginTop:"30px"},children:[e.jsx("l-waveform",{size:"35",stroke:"3.5",speed:"1",color:"black"}),e.jsx("h3",{style:{marginLeft:"20px"},children:"Loading"})]})]})}),e.jsxs(W,{backdrop:"static",visible:u,onClose:()=>g(!1),"aria-labelledby":"StaticBackdropExampleLabel",children:[e.jsx(he,{children:e.jsx(X,{id:"StaticBackdropExampleLabel",children:"Update"})}),e.jsx(Y,{children:e.jsxs(E,{onSubmit:G,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(ee,{htmlFor:"exampleFormControlInput1",children:"Group Name"}),e.jsx(H,{type:"text",id:"exampleFormControlInput1",placeholder:"Group Name",onChange:t=>v({...i,groupName:t.target.value}),value:i.groupName})]}),e.jsx("div",{className:"col-auto",style:{width:"100%"},children:F?e.jsxs(p,{color:"success",type:"submit",className:"mb-3",disabled:!0,style:{width:"100%"},children:[e.jsx(J,{as:"span",size:"sm"})," Updating information ..."]}):e.jsx(p,{color:"primary",type:"submit",className:"mb-3",style:{width:"100%"},children:"UPDATE"})})]})})]})]})}export{ze as default};
