import{r as l,_ as j,R as S,a as w,c as b,P as c,n as v,A as C,j as e}from"./index-C301rl4l.js";import{S as y}from"./sweetalert2.esm.all-DOYwHpwi.js";import{a as g,b as x,c as P,d as E}from"./CRow-DzvM-Fku.js";import{C as D,a as F}from"./CCardBody-BB8X-jUM.js";import{C as M}from"./CImage-D16IBx2c.js";import{k as I}from"./DefaultLayout-D85aDnQc.js";import{C as k}from"./CForm-DyX8Mp35.js";import{C as R}from"./CFormInput-VSLTUyno.js";import"./index.esm-DfaUp9eW.js";import"./CAlert-DXt3K87V.js";import"./CFormSelect-CWPKjNEb.js";var u=l.forwardRef(function(t,p){var s=t.children,a=t.className,r=j(t,["children","className"]);return S.createElement("div",w({className:b("card-footer",a)},r,{ref:p}),s)});u.propTypes={children:c.node,className:c.string};u.displayName="CCardFooter";var f=l.forwardRef(function(t,p){var s=t.children,a=t.as,r=a===void 0?"p":a,m=t.className,o=j(t,["children","as","className"]);return S.createElement(r,w({className:b("card-text",m)},o,{ref:p}),s)});f.propTypes={as:c.elementType,children:c.node,className:c.string};f.displayName="CCardText";function L(){v();const{purchaseSmsUnit:t,setPurchaseSmsUnit:p}=l.useContext(C),{OrganisationDataID:s,setOrganisationDataID:a}=l.useContext(C),[r,m]=l.useState(""),o=t.quantity*t.price,N=async h=>{h.preventDefault();try{const n=await fetch("https://81c9-69-197-145-100.ngrok-free.app/mpesapayment",{method:"POST",headers:{"Content-Type":"application/json"},body:r});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const d=await n.text();if(console.log(d),d==="Success"){try{console.log(s);const i=await fetch(`https://81c9-69-197-145-100.ngrok-free.app/update-organisation-payment/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({total:o,quantity:t.quantity})});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const T=await i.text();console.log(T)}catch(i){console.error("There was a problem with the fetch operation:",i)}y.fire({title:d,text:"Paid Successfully",icon:"success"})}else y.fire({icon:"error",title:d,text:"Something went wrong! Check Mpesa Code and try again"})}catch(n){console.error("There was a problem with the fetch operation:",n)}};return e.jsx(e.Fragment,{children:e.jsx(g,{children:e.jsx(x,{xs:10,style:{margin:"12px auto"},children:e.jsx(D,{style:{boxShadow:"0px 15px 34px 0px rgba(0,0,0,0.2)"},children:e.jsxs(F,{children:[e.jsx("div",{style:{margin:"auto 0px",backgroundColor:"#0074d9",color:"#fff",height:"60px",borderRadius:"10px"},children:e.jsxs(g,{children:[e.jsx(x,{children:e.jsx("div",{style:{padding:"15px 25px",fontSize:"20px"},children:"Payment Date:  12/10/2024 15:17:29"})}),e.jsx(x,{children:e.jsxs("div",{style:{display:"flex",justifyContent:"end",alignItems:"center",padding:"15px 25px",fontSize:"20px"},children:["Sms Total:  ",o]})})]})}),e.jsxs(f,{style:{padding:"15px 20px"},children:[e.jsx("p",{children:e.jsx(M,{src:"src/assets/images/m-pesa.png",height:81})}),e.jsx("p",{children:"1. Go to the M-PESA menu on your phone "}),e.jsx("p",{children:"2. Select Buy Goods and Services Option"}),e.jsx("p",{children:"3. Enter the following till number: 5592679"}),e.jsxs("p",{children:["4. Enter the total amount (KSh.",o," )"]}),e.jsx("p",{children:"5. Enter your PIN and then send the money"}),e.jsx("p",{children:"6. You will receive a transaction confirmation SMS from M-PESA"}),e.jsx("p",{children:"7. Enter your M-PESA Confirmation Code only here below:"})]}),e.jsx(u,{children:e.jsxs(I,{color:"success",children:[e.jsx("h5",{children:"Enter Payment Details"}),e.jsx(k,{onSubmit:N,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(P,{htmlFor:"exampleFormControlInput1",children:"Mpesa Code"}),e.jsx(R,{type:"text",id:"exampleFormControlInput1",placeholder:"Mpesa Code",style:{borderColor:"rgba(71, 71, 212,0.6)",width:"40%"},value:r,onChange:h=>m(h.target.value)}),e.jsx("div",{className:"col-auto",children:e.jsx(E,{color:"success",type:"submit",style:{marginTop:"20px",color:"#fff"},children:"Confirm"})})]})})]})})]})})})})})}export{L as default};
