import{r as p,R as T,c as D,P as n,_ as O,a as g,b as M,h as z,j as e,L as A}from"./index-DxiAcUCP.js";import{C as F}from"./index.esm-Cy3LKcd6.js";import{C as Z,a as P}from"./CRow-BRiTm5IC.js";import{C as U,a as G}from"./CCardBody-CGlVQwBB.js";import{C as B}from"./CCardTitle-gVDurk02.js";import{C as H}from"./CAlert-7UTiU2fV.js";import{C as $}from"./CFormSelect-tuFcfyUE.js";import{C as _,b}from"./CContainer-HlgF_dlK.js";import{C as J,a as K}from"./CModalBody-DgXVUmU_.js";import{C as W}from"./CModalTitle-D3dW3WEl.js";import"./CCloseButton-BkFP51Rh.js";import"./CFormControlWrapper-BYq7y8h4.js";import"./DefaultLayout-BmgnOIWU.js";var N=p.forwardRef(function(s,h){var i,f=s.children,c=s.as,d=c===void 0?"ul":c,t=s.className,u=s.flush,m=s.layout;return T.createElement(d,{className:D("list-group",(i={"list-group-flush":u},i["list-group-".concat(m)]=m,i),t),ref:h},f)});N.propTypes={as:n.elementType,children:n.node,className:n.string,flush:n.bool,layout:n.oneOf(["horizontal","horizontal-sm","horizontal-md","horizontal-lg","horizontal-xl","horizontal-xxl"])};N.displayName="CListGroup";var V=p.forwardRef(function(s,h){var i,f=s.children,c=s.active,d=s.as,t=d===void 0?"li":d,u=s.className,m=s.disabled,C=s.color,x=O(s,["children","active","as","className","disabled","color"]),w=t==="a"||t==="button"?_:t;return x=g(g(g(g({},(t==="a"||t==="button")&&{active:c,disabled:m,as:t,ref:h}),c&&{"aria-current":!0}),m&&{"aria-disabled":!0}),x),T.createElement(w,g({className:D("list-group-item",(i={},i["list-group-item-".concat(C)]=C,i["list-group-item-action"]=t==="a"||t==="button",i.active=c,i.disabled=m,i),u)},x),f)});V.propTypes={active:n.bool,as:n.elementType,children:n.node,className:n.string,color:M,disabled:n.bool};V.displayName="CListGroupItem";var q=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='346.231 284.746 256.039 194.554 165.847 284.746 188.474 307.373 240.039 255.808 240.039 496 272.039 496 272.039 255.808 323.604 307.373 346.231 284.746' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M400,161.453V160c0-79.4-64.6-144-144-144S112,80.6,112,160v2.491A122.285,122.285,0,0,0,49.206,195.2,109.4,109.4,0,0,0,16,273.619c0,31.119,12.788,60.762,36.01,83.469C74.7,379.275,105.338,392,136.07,392H200V360H136.07C89.154,360,48,319.635,48,273.619c0-42.268,35.64-77.916,81.137-81.155L144,191.405V160a112,112,0,0,1,224,0v32.04l15.8.2c46.472.588,80.2,34.813,80.2,81.379C464,322.057,428.346,360,382.83,360H312v32h70.83a109.749,109.749,0,0,0,81.14-35.454C484.625,334.339,496,304.889,496,273.619,496,215.182,455.716,169.392,400,161.453Z' class='ci-primary'/>"],Q=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M334.627,16H48V496H472V153.373ZM440,166.627V168H320V48h1.373ZM80,464V48H288V200H440V464Z' class='ci-primary'/>"],X=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M96,472a23.82,23.82,0,0,0,23.579,24H392.421A23.82,23.82,0,0,0,416,472V152H96Zm32-288H384V464H128Z' class='ci-primary'/><rect width='32' height='200' x='168' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='200' x='240' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='200' x='312' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M328,88V40c0-13.458-9.488-24-21.6-24H205.6C193.488,16,184,26.542,184,40V88H64v32H448V88ZM216,48h80V88H216Z' class='ci-primary'/>"];function me(){const[s,h]=p.useState([]),[i,f]=p.useState(!1),[c,d]=p.useState(""),t=p.useRef(),[u,m]=p.useState([]),C=z.get("groupId"),[x,w]=p.useState(),v=r=>{const o=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],a=[".xls",".xlsx"];return o.includes(r.type)||a.some(y=>r.name.toLowerCase().endsWith(y))},S=r=>{r.preventDefault()},E=r=>{r.preventDefault();const o=Array.from(r.dataTransfer.files),a=o.filter(v);o.filter(l=>!v(l)).length>0?d("Only Excel files (.xls, .xlsx) are allowed."):d(""),h(l=>[...l,...a])},k=r=>{const o=Array.from(r.target.files),a=o.filter(v);o.filter(l=>!v(l)).length>0?d("Only Excel files (.xls, .xlsx) are allowed."):d(""),h(l=>[...l,...a])},I=r=>{h(o=>o.filter(a=>a!==r))},L=()=>{f(!0);const r=a=>new Promise((y,l)=>{const j=new FileReader;j.readAsDataURL(a),j.onload=()=>y(j.result),j.onerror=R=>l(R)});(async()=>{try{const a=await Promise.all(s.map(async l=>({filename:l.name,contentType:l.type,data:await r(l)})));fetch("https://wazimobile-sms-backend.onrender.com/messageinfile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgCode:x,files:a})}).then(l=>l.text()).then(l=>console.log(l)).catch(l=>console.error("Error:",l))}catch(a){console.error("Error encoding files:",a)}})()};return p.useEffect(()=>{try{fetch(`https://wazimobile-sms-backend.onrender.com/org_group_id/${C}`).then(r=>(console.log(r),r.json())).then(r=>{console.log(r),m(r)}).catch(r=>{console.log(r)})}catch(r){console.error("There was a problem with the fetch operation:",r)}},[]),e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"justify-content-md-center",children:e.jsx(P,{xs:10,children:e.jsx(U,{className:"mb-4",style:{boxShadow:"0px 15px 34px 0px rgba(0,0,0,0.2)"},children:e.jsxs(G,{children:[e.jsx(B,{children:e.jsxs(H,{color:"primary",variant:"solid",className:"d-flex align-items-center",xs:10,children:[e.jsx(F,{icon:Q,className:"flex-shrink-0 me-2",width:34,height:34}),e.jsx("div",{children:e.jsx("h3",{children:"Upload file"})})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs($,{id:"exampleFormControlInput1","aria-label":"Default select example",value:x,onChange:r=>w(r.target.value),style:{borderColor:"rgba(71, 71, 212,0.6)"},children:[e.jsx("option",{value:"",children:"Select Sender Id"})," ",u&&u.map((r,o)=>e.jsx("option",{value:r.org_Code,children:r.url},o))]})}),e.jsxs("div",{style:{background:"#f3f4f6",border:"2px dashed rgba(71, 71, 212,0.6)",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",color:"gray",padding:"20px"},onDragOver:S,onDrop:E,children:[e.jsx(F,{icon:q,size:"3xl"}),e.jsx("h3",{children:"Drag and Drop files to upload"}),e.jsx("h3",{children:"Or"}),e.jsx("input",{type:"file",multiple:!0,onChange:k,hidden:!0,ref:t}),e.jsx(b,{type:"button",color:"dark",id:"inputGroupFileAddon04",onClick:()=>t.current.click(),style:{margin:"20px"},children:"Select Files"})]}),c&&e.jsx(H,{color:"danger",children:c}),s.length>0&&e.jsxs("div",{style:{margin:"40px"},children:[e.jsx(N,{flush:!0,children:s.map((r,o)=>e.jsxs(V,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.name,e.jsx(b,{color:"danger",style:{color:"#fff"},onClick:()=>I(r),children:e.jsx(F,{icon:X})})]},o))}),e.jsx("div",{style:{margin:"15px",width:"100%"},className:"d-grid gap-2",children:e.jsx(b,{color:"success",onClick:L,style:{marginRight:"20px",color:"#fff"},xs:10,children:"Upload"})})]})]})})})}),e.jsx(J,{visible:i,onClose:()=>f(!1),"aria-labelledby":"LiveDemoExampleLabel",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(K,{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",padding:"50px",textAlign:"center"},children:[e.jsx(W,{style:{width:"100%"},children:e.jsx("h2",{children:"Uploaded Successfully"})}),e.jsx(A,{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(b,{color:"primary",className:"mt-3",style:{width:"80%"},onClick:()=>f(!1),children:"OK"})})]})})]})}export{me as default};
