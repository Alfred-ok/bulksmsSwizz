import{r as o,e as E,j as e}from"./index-C301rl4l.js";import{C as D}from"./index.esm-DfaUp9eW.js";import{r as I,u as T}from"./xlsx-DG2X6oDA.js";import{S as k}from"./sweetalert2.esm.all-DOYwHpwi.js";import{a as O,b as M,c as _,d as A}from"./CRow-DzvM-Fku.js";import{C as $,a as B}from"./CCardBody-BB8X-jUM.js";import{C as P,a as R}from"./DefaultLayout-D85aDnQc.js";import{C as u}from"./CAlert-DXt3K87V.js";import{C as G}from"./CForm-DyX8Mp35.js";import{C as U}from"./CFormSelect-CWPKjNEb.js";import{C as J}from"./CFormInput-VSLTUyno.js";import{C as L}from"./CFormTextarea-hccMW2jx.js";function te(){const[d,i]=o.useState(""),[x,g]=o.useState([]),[l,C]=o.useState(""),[c,j]=o.useState(""),[m,y]=o.useState([]),p=E.get("groupId"),b=r=>["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(r.type),S=async r=>{const s=r.target.files[0];if(!s||!b(s)){i("Only Excel files (.xls, .xlsx) are allowed.");return}i("");try{const t=new FileReader;t.onload=a=>{const n=new Uint8Array(a.target.result),h=I(n,{type:"array"}),F=h.SheetNames[0],w=h.Sheets[F],N=T.sheet_to_json(w,{header:1}).flat().filter(f=>typeof f=="number"||/^\d+$/.test(f));y(N)},t.readAsArrayBuffer(s)}catch(t){console.error("Error reading Excel file:",t)}},v=async r=>{if(r.preventDefault(),!l||!c||m.length===0){i("Please fill all fields and upload a valid file.");return}const s=m.join(","),t={code:l,phoneNumber:s,message:c};try{const n=await(await fetch("https://81c9-69-197-145-100.ngrok-free.app/group-messagein-file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).text();k.fire({title:n,text:"Message Sent",icon:"success"}),console.log(n)}catch(a){console.error("Error submitting data:",a)}};return o.useEffect(()=>{(async()=>{try{const t=await(await fetch(`https://81c9-69-197-145-100.ngrok-free.app/org_group_id/${p}`)).json();g(t)}catch(s){console.error("Error fetching organisation data:",s)}})()},[p]),e.jsx(e.Fragment,{children:e.jsx(O,{className:"justify-content-md-center",children:e.jsx(M,{xs:10,children:e.jsx($,{className:"mb-4",style:{boxShadow:"0px 15px 34px 0px rgba(0,0,0,0.2)"},children:e.jsxs(B,{children:[e.jsx(P,{children:e.jsxs(u,{color:"primary",variant:"solid",className:"d-flex align-items-center",xs:10,children:[e.jsx(D,{icon:R,className:"flex-shrink-0 me-2",width:34,height:34}),e.jsx("div",{children:e.jsx("h3",{children:"Send Group SMS from File"})})]})}),e.jsxs(G,{onSubmit:v,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(_,{htmlFor:"senderId",children:"Select Sender ID"}),e.jsxs(U,{id:"senderId",value:l,onChange:r=>C(r.target.value),style:{borderColor:"rgba(71, 71, 212,0.6)"},children:[e.jsx("option",{value:"",children:"Select Sender ID"}),x.map((r,s)=>e.jsx("option",{value:r.org_Code,children:r.url},s))]})]}),e.jsx("div",{className:"mb-3",children:e.jsx(J,{type:"file",id:"formFile",label:"Upload Excel File",onChange:S,style:{borderColor:"rgba(71, 71, 212,0.6)"}})}),d&&e.jsx(u,{color:"danger",children:d}),e.jsx("div",{className:"mb-3",children:e.jsx(L,{id:"textMessage",label:"Text Message",rows:3,value:c,onChange:r=>j(r.target.value),style:{borderColor:"rgba(71, 71, 212,0.6)"}})}),e.jsx(A,{type:"submit",color:"primary",children:"Submit"})]})]})})})})})}export{te as default};
